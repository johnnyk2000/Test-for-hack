#include "BluetoothSerial.h"

#if !defined(CONFIG_BT_ENABLED) || !defined(CONFIG_BLUEDROID_ENABLED)           //error catching
#error Bluetooth is not enabled! Please run `make menuconfig` to and enable it
#endif

BluetoothSerial SerialBT; //Bluetooth Connection

#define SPEED 19
#define FORWARD 18
#define BACKWARD 5

void setup() 
{
  pinMode(SPEED, OUTPUT);
  pinMode(FORWARD, OUTPUT);
  pinMode(BACKWARD, OUTPUT);
  
  Serial.begin(115200);
  SerialBT.begin("ESP_TMM"); //Bluetooth name is ESP_TMM
  Serial.println("Started successfully.");

  digitalWrite(SPEED, LOW);
  digitalWrite(FORWARD, LOW);
  digitalWrite(BACKWARD, LOW);
  
}

char readIn;

void loop() 
{
  if (SerialBT.available()) //if there are bytes available in the buffer
  {
    readIn = char(SerialBT.read()); //read in one and store it in readIn
  }

  if (readIn == 'w') 
  {
    digitalWrite(SPEED, 100);
    digitalWrite(FORWARD, HIGH);
    digitalWrite(BACKWARD, LOW);
    SerialBT.println("going forward!");
  }
  else if (readIn == 's'){
    digitalWrite(SPEED, 100);
    digitalWrite(BACKWARD, HIGH);
    digitalWrite(FORWARD, LOW);
    SerialBT.println("going backward");
  }
  else if (readIn == 'x'){
    digitalWrite(SPEED, 0);
    digitalWrite(BACKWARD, LOW);
    digitalWrite(FORWARD, LOW);
    SerialBT.println("STOP");
  }
    
  delay(20);

}
